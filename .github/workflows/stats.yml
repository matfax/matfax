name: stats

on:
  workflow_dispatch:
  schedule:
    - cron: '30 1 * * *'

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout tools repo
        uses: actions/checkout@v2.3.3
        with:
          repository: anmol098/waka-readme-stats
          path: waka
          persist-credentials: false
      - name: cache docker layers
        uses: satackey/action-docker-layer-caching@v0.0.8
        continue-on-error: true
        with:
          key: waka-${{ hashFiles('./waka/Dockerfile') }}-${{ hashFiles('./waka/requirements.txt') }}-${{ hashFiles('./waka/**.*') }}
          restore-keys: |
            waka-${{ hashFiles('./waka/Dockerfile') }}-${{ hashFiles('./waka/requirements.txt') }}-${{ hashFiles('./waka/**.*') }}
            waka-${{ hashFiles('./waka/Dockerfile') }}-${{ hashFiles('./waka/requirements.txt') }}
            waka-${{ hashFiles('./waka/Dockerfile') }}
      - name: update stats
        uses: ./waka/
        with:
          WAKATIME_API_KEY: ${{ secrets.WAKATIME_API_KEY }}
          GH_TOKEN: ${{ secrets.PAT }}
          SHOW_OS: False
          SHOW_TIMEZONE: False
          SHOW_LOC_CHART: False
          SHOW_PROFILE_VIEWS: False
          SHOW_LINES_OF_CODE: False
          SHOW_COMMIT: False
          SHOW_DAYS_OF_WEEK: False
          SHOW_LANGUAGE_PER_REPO: False
          SHOW_LANGUAGE: True
          SHOW_PROJECTS: True
